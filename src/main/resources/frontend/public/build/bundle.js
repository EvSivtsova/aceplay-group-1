var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function s(t){t.forEach(e)}function a(t){return"function"==typeof t}function i(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function o(t,e){t.appendChild(e)}function r(t,e,n){t.insertBefore(e,n||null)}function c(t){t.parentNode.removeChild(t)}function l(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function f(){return d(" ")}function h(){return d("")}function p(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function m(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function b(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function k(t,e){t.value=null==e?"":e}function g(t,e){for(let n=0;n<t.options.length;n+=1){const s=t.options[n];if(s.__value===e)return void(s.selected=!0)}t.selectedIndex=-1}let $;function T(t){$=t}function y(){const t=function(){if(!$)throw new Error("Function called outside component initialization");return $}();return(e,n)=>{const s=t.$$.callbacks[e];if(s){const a=function(t,e,n=!1){const s=document.createEvent("CustomEvent");return s.initCustomEvent(t,n,!1,e),s}(e,n);s.slice().forEach((e=>{e.call(t,a)}))}}}const w=[],A=[],v=[],E=[],_=Promise.resolve();let S=!1;function U(t){v.push(t)}let N=!1;const x=new Set;function I(){if(!N){N=!0;do{for(let t=0;t<w.length;t+=1){const e=w[t];T(e),D(e.$$)}for(T(null),w.length=0;A.length;)A.pop()();for(let t=0;t<v.length;t+=1){const e=v[t];x.has(e)||(x.add(e),e())}v.length=0}while(w.length);for(;E.length;)E.pop()();S=!1,N=!1,x.clear()}}function D(t){if(null!==t.fragment){t.update(),s(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(U)}}const L=new Set;let C;function P(){C={r:0,c:[],p:C}}function O(){C.r||s(C.c),C=C.p}function H(t,e){t&&t.i&&(L.delete(t),t.i(e))}function j(t,e,n,s){if(t&&t.o){if(L.has(t))return;L.add(t),C.c.push((()=>{L.delete(t),s&&(n&&t.d(1),s())})),t.o(e)}}function R(t){t&&t.c()}function G(t,n,i,o){const{fragment:r,on_mount:c,on_destroy:l,after_update:u}=t.$$;r&&r.m(n,i),o||U((()=>{const n=c.map(e).filter(a);l?l.push(...n):s(n),t.$$.on_mount=[]})),u.forEach(U)}function Y(t,e){const n=t.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function z(t,e){-1===t.$$.dirty[0]&&(w.push(t),S||(S=!0,_.then(I)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(e,a,i,o,r,l,u,d=[-1]){const f=$;T(e);const h=e.$$={fragment:null,ctx:null,props:l,update:t,not_equal:r,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(f?f.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:a.target||f.$$.root};u&&u(h.root);let p=!1;if(h.ctx=i?i(e,a.props||{},((t,n,...s)=>{const a=s.length?s[0]:n;return h.ctx&&r(h.ctx[t],h.ctx[t]=a)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](a),p&&z(e,t)),n})):[],h.update(),p=!0,s(h.before_update),h.fragment=!!o&&o(h.ctx),a.target){if(a.hydrate){const t=function(t){return Array.from(t.childNodes)}(a.target);h.fragment&&h.fragment.l(t),t.forEach(c)}else h.fragment&&h.fragment.c();a.intro&&H(e.$$.fragment),G(e,a.target,a.anchor,a.customElement),I()}T(f)}class F{$destroy(){Y(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const J=window.location.toString().includes(":5000")?"http://localhost:8080":"";class M{constructor(){this.state="UNAUTH",this.backends={},this.session=null}subscribe(t,e){if("AUTHED"!==this.state)throw new Error("Not authenticated");this._subscribeToBackend(t,e)}async isAuthenticated(){if("UNAUTH"===this.state){let t=JSON.parse(localStorage.getItem("session"));if(t){this.state="PENDING_AUTH";let e=await fetch(J+"/api/session",{headers:{Authorization:t.token}});return 200===e.status?(this.state="AUTHED",this.session=await e.json(),!0):(this.state="UNAUTH",this.authenticationPromise=null,!1)}return!1}}async authenticate(t,e){this.state="PENDING_AUTH";let n=await fetch(J+"/api/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:e})});if(200===n.status){let t=await n.json();return this.state="AUTHED",this.session=t,localStorage.setItem("session",JSON.stringify(t)),!0}return this.state="UNAUTH",this.authenticationPromise=null,!1}async signUp(t,e){this.state="PENDING_AUTH";let n=await fetch(J+"/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:e})});if(200===n.status){let t=await n.json();return this.state="AUTHED",this.session=t,localStorage.setItem("session",JSON.stringify(t)),!0}return this.state="UNAUTH",this.authenticationPromise=null,!1}async addPlaylist(t){if(200===(await fetch(J+"/api/playlists",{method:"POST",headers:{Authorization:this.session.token,"Content-Type":"application/json"},body:JSON.stringify(t)})).status)return this.backends.PLAYLIST_LIST&&this.backends.PLAYLIST_LIST.refresh(),!0;throw new Error("Failed to create playlist")}async getUploadRequestInfo(t,e){const n=await fetch(J+"/api/storage/upload_key?"+new URLSearchParams({filename:t,contentType:e}),{headers:{Authorization:this.session.token}});if(200!==n.status)throw new Error("Failed to get track upload key");return await n.json()}async submitTrack(t,e,n){if(200!==(await fetch(J+"/api/tracks",{method:"POST",headers:{Authorization:this.session.token,"Content-Type":"application/json"},body:JSON.stringify({title:t,artist:e,publicUrl:n})})).status)throw new Error("Failed to submit track");return this.backends.TRACK_LIST.refresh(),!0}async deleteTrack(t){if(200!==(await fetch(J+"/api/tracks/"+t,{method:"DELETE",headers:{Authorization:this.session.token}})).status)throw new Error("Error deleting track");this.backends.TRACK_LIST.refresh(),this.backends.PLAYLIST_LIST.refresh()}async addTrackToPlaylist(t,e){if(200!==(await fetch(J+"/api/playlists/"+t+"/tracks",{method:"PUT",headers:{Authorization:this.session.token,"Content-Type":"application/json"},body:JSON.stringify({id:e})})).status)throw new Error("Error adding track to playlist");this.backends.PLAYLIST_LIST.refresh()}async removeTrackFromPlaylist(t,e){if(200!==(await fetch(J+"/api/playlists/"+t+"/tracks/"+e,{method:"DELETE",headers:{Authorization:this.session.token}})).status)throw new Error("Error deleting track from playlist")}signOut(){this.state="UNAUTH",this.session=null,localStorage.removeItem("session"),this.backends={}}_subscribeToBackend(t,e){if(!this.backends[t])if("TRACK_LIST"==t)this.backends[t]=new K(this.session);else if("USER"==t)this.backends[t]=new q(this.session);else{if("PLAYLIST_LIST"!=t)throw new Error(`Invalid channel ${t}`);this.backends[t]=new Q(this.session)}this.backends[t].subscribe(e)}}class K{constructor(t){this.session=t,this.state="NOT_YET_USED",this.callbacks=[]}subscribe(t){"NOT_YET_USED"===this.state?(this.callbacks.push(t),this.loadData()):"DATA_REQUESTED"===this.state?this.callbacks.push(t):"DATA_LOADED"===this.state&&t(this.data)}async loadData(){this.state="DATA_REQUESTED";const t=await fetch(J+"/api/tracks",{headers:{Authorization:this.session.token}});this.data=await t.json(),this.state="DATA_LOADED",this.callbacks.forEach((t=>t(this.data)))}refresh(){this.loadData()}}class Q{constructor(t){this.session=t,this.state="NOT_YET_USED",this.callbacks=[]}subscribe(t){"NOT_YET_USED"===this.state?(this.state="DATA_REQUESTED",this.callbacks.push(t),this.loadData()):"DATA_REQUESTED"===this.state?this.callbacks.push(t):"DATA_LOADED"===this.state&&(this.callbacks.push(t),t(this.data))}async loadData(){const t=await fetch(J+"/api/playlists",{headers:{Authorization:this.session.token}});this.data=await t.json(),this.state="DATA_LOADED",this.callbacks.forEach((t=>t(this.data)))}refresh(){this.loadData()}}class q{constructor(t){this.session=t}subscribe(t){t(this.session.user)}}function V(e){let n,a,i,o,l,d,h,b,g,$,T;return{c(){n=u("label"),n.textContent="Username",a=f(),i=u("input"),o=f(),l=u("label"),l.textContent="Password",d=f(),h=u("input"),b=f(),g=u("button"),g.textContent="Log In",m(n,"for","login-username"),m(i,"id","login-username"),m(l,"for","login-password"),m(h,"type","password"),m(h,"id","login-password"),m(g,"type","button")},m(t,s){r(t,n,s),r(t,a,s),r(t,i,s),k(i,e[0]),r(t,o,s),r(t,l,s),r(t,d,s),r(t,h,s),k(h,e[1]),r(t,b,s),r(t,g,s),$||(T=[p(i,"input",e[3]),p(h,"input",e[4]),p(g,"click",e[2])],$=!0)},p(t,[e]){1&e&&i.value!==t[0]&&k(i,t[0]),2&e&&h.value!==t[1]&&k(h,t[1])},i:t,o:t,d(t){t&&c(n),t&&c(a),t&&c(i),t&&c(o),t&&c(l),t&&c(d),t&&c(h),t&&c(b),t&&c(g),$=!1,s(T)}}}function W(t,e,n){const s=y();let a="",i="";return[a,i,async function(t){s("loginSubmit",{username:a,password:i})},function(){a=this.value,n(0,a)},function(){i=this.value,n(1,i)}]}class X extends F{constructor(t){super(),B(this,t,W,V,i,{})}}function Z(e){let n,a,i,o,l,d,h,b,g,$,T;return{c(){n=u("label"),n.textContent="Username",a=f(),i=u("input"),o=f(),l=u("label"),l.textContent="Password",d=f(),h=u("input"),b=f(),g=u("button"),g.textContent="Sign Up",m(n,"for","login-username"),m(i,"id","login-username"),m(l,"for","login-password"),m(h,"type","password"),m(h,"id","login-password"),m(g,"type","button")},m(t,s){r(t,n,s),r(t,a,s),r(t,i,s),k(i,e[0]),r(t,o,s),r(t,l,s),r(t,d,s),r(t,h,s),k(h,e[1]),r(t,b,s),r(t,g,s),$||(T=[p(i,"input",e[3]),p(h,"input",e[4]),p(g,"click",e[2])],$=!0)},p(t,[e]){1&e&&i.value!==t[0]&&k(i,t[0]),2&e&&h.value!==t[1]&&k(h,t[1])},i:t,o:t,d(t){t&&c(n),t&&c(a),t&&c(i),t&&c(o),t&&c(l),t&&c(d),t&&c(h),t&&c(b),t&&c(g),$=!1,s(T)}}}function tt(t,e,n){const s=y();let a="",i="";return[a,i,async function(){s("signupSubmit",{username:a,password:i})},function(){a=this.value,n(0,a)},function(){i=this.value,n(1,i)}]}class et extends F{constructor(t){super(),B(this,t,tt,Z,i,{})}}function nt(t,e,n){const s=t.slice();return s[8]=e[n],s}function st(e){let n;return{c(){n=u("p"),n.textContent="Fetching playlists..."},m(t,e){r(t,n,e)},p:t,d(t){t&&c(n)}}}function at(t){let e,n,a,i,d,h,b,g,$,T,y,w,A,v=t[0],E=[];for(let e=0;e<v.length;e+=1)E[e]=it(nt(t,v,e));return{c(){for(let t=0;t<E.length;t+=1)E[t].c();e=f(),n=u("div"),a=u("h4"),a.textContent="Create new playlist",i=f(),d=u("label"),d.textContent="Playlist Name",h=f(),b=u("div"),g=u("input"),$=f(),T=u("div"),y=u("button"),y.textContent="Add Playlist",m(d,"for","new-playlist-name"),m(g,"id","new-playlist-name"),m(g,"type","text"),m(n,"class","new-playlist-form svelte-nhe55f")},m(s,c){for(let t=0;t<E.length;t+=1)E[t].m(s,c);r(s,e,c),r(s,n,c),o(n,a),o(n,i),o(n,d),o(n,h),o(n,b),o(b,g),k(g,t[1]),o(n,$),o(n,T),o(T,y),w||(A=[p(g,"input",t[6]),p(y,"click",t[3])],w=!0)},p(t,n){if(5&n){let s;for(v=t[0],s=0;s<v.length;s+=1){const a=nt(t,v,s);E[s]?E[s].p(a,n):(E[s]=it(a),E[s].c(),E[s].m(e.parentNode,e))}for(;s<E.length;s+=1)E[s].d(1);E.length=v.length}2&n&&g.value!==t[1]&&k(g,t[1])},d(t){l(E,t),t&&c(e),t&&c(n),w=!1,s(A)}}}function it(t){let e,n,s,a,i,l=t[8].name+"";function f(){return t[5](t[8])}return{c(){e=u("div"),n=u("button"),s=d(l)},m(t,c){r(t,e,c),o(e,n),o(n,s),a||(i=p(n,"click",f),a=!0)},p(e,n){t=e,1&n&&l!==(l=t[8].name+"")&&b(s,l)},d(t){t&&c(e),a=!1,i()}}}function ot(e){let n;function s(t,e){return t[0]?at:st}let a=s(e),i=a(e);return{c(){i.c(),n=h()},m(t,e){i.m(t,e),r(t,n,e)},p(t,[e]){a===(a=s(t))&&i?i.p(t,e):(i.d(1),i=a(t),i&&(i.c(),i.m(n.parentNode,n)))},i:t,o:t,d(t){i.d(t),t&&c(n)}}}function rt(t,e,n){const s=y();let{backend:a}=e,i=null;function o(t){s("showPlaylist",t)}a.subscribe("PLAYLIST_LIST",(t=>{n(0,i=t)}));let r="";return t.$$set=t=>{"backend"in t&&n(4,a=t.backend)},[i,r,o,async function(){let t={name:r};n(1,r=""),await a.addPlaylist(t)},a,t=>o(t),function(){r=this.value,n(1,r)}]}class ct extends F{constructor(t){super(),B(this,t,rt,ot,i,{backend:4})}}function lt(t,e,n){const s=t.slice();return s[4]=e[n],s}function ut(t){let e,n,s,a,i,l,h,k,g,$,T,y,w=t[4].title+"",A=t[4].artist+"";function v(){return t[2](t[4])}return{c(){e=u("div"),n=u("div"),s=d(w),a=f(),i=u("div"),l=d(A),h=f(),k=u("div"),g=u("button"),g.textContent="Delete",$=f(),m(n,"class","track-name"),m(i,"class","track-artist"),m(k,"class","track-ctrl"),m(e,"class","track svelte-y6jlu0")},m(t,c){r(t,e,c),o(e,n),o(n,s),o(e,a),o(e,i),o(i,l),o(e,h),o(e,k),o(k,g),o(e,$),T||(y=p(g,"click",v),T=!0)},p(e,n){t=e,1&n&&w!==(w=t[4].title+"")&&b(s,w),1&n&&A!==(A=t[4].artist+"")&&b(l,A)},d(t){t&&c(e),T=!1,y()}}}function dt(e){let n,s=e[0],a=[];for(let t=0;t<s.length;t+=1)a[t]=ut(lt(e,s,t));return{c(){for(let t=0;t<a.length;t+=1)a[t].c();n=h()},m(t,e){for(let n=0;n<a.length;n+=1)a[n].m(t,e);r(t,n,e)},p(t,[e]){if(3&e){let i;for(s=t[0],i=0;i<s.length;i+=1){const o=lt(t,s,i);a[i]?a[i].p(o,e):(a[i]=ut(o),a[i].c(),a[i].m(n.parentNode,n))}for(;i<a.length;i+=1)a[i].d(1);a.length=s.length}},i:t,o:t,d(t){l(a,t),t&&c(n)}}}function ft(t,e,n){const s=y();function a(t){s("deleteTrack",t)}let{tracks:i}=e;return t.$$set=t=>{"tracks"in t&&n(0,i=t.tracks)},[i,a,t=>a(t)]}class ht extends F{constructor(t){super(),B(this,t,ft,dt,i,{tracks:0})}}function pt(t,e,n){const s=t.slice();return s[5]=e[n],s}function mt(t){let e,n,s,a,i,l=t[5].title+"",f=t[5].artist+"";return{c(){e=u("option"),n=d(l),s=d(" by "),a=d(f),e.__value=i=t[5],e.value=e.__value},m(t,i){r(t,e,i),o(e,n),o(e,s),o(e,a)},p(t,s){1&s&&l!==(l=t[5].title+"")&&b(n,l),1&s&&f!==(f=t[5].artist+"")&&b(a,f),1&s&&i!==(i=t[5])&&(e.__value=i,e.value=e.__value)},d(t){t&&c(e)}}}function bt(e){let n,a,i,d,h,b,k=e[0],$=[];for(let t=0;t<k.length;t+=1)$[t]=mt(pt(e,k,t));return{c(){n=u("select"),a=u("option"),a.textContent="Select a track";for(let t=0;t<$.length;t+=1)$[t].c();i=f(),d=u("button"),d.textContent="Add",a.__value="",a.value=a.__value,void 0===e[1]&&U((()=>e[3].call(n))),m(d,"type","button")},m(t,s){r(t,n,s),o(n,a);for(let t=0;t<$.length;t+=1)$[t].m(n,null);g(n,e[1]),r(t,i,s),r(t,d,s),h||(b=[p(n,"change",e[3]),p(d,"click",e[2])],h=!0)},p(t,[e]){if(1&e){let s;for(k=t[0],s=0;s<k.length;s+=1){const a=pt(t,k,s);$[s]?$[s].p(a,e):($[s]=mt(a),$[s].c(),$[s].m(n,null))}for(;s<$.length;s+=1)$[s].d(1);$.length=k.length}3&e&&g(n,t[1])},i:t,o:t,d(t){t&&c(n),l($,t),t&&c(i),t&&c(d),h=!1,s(b)}}}function kt(t,e,n){const s=y();let a,{allTracks:i}=e;return t.$$set=t=>{"allTracks"in t&&n(0,i=t.allTracks)},[i,a,function(){s("addTrack",a)},function(){a=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),n(1,a),n(0,i)}]}class gt extends F{constructor(t){super(),B(this,t,kt,bt,i,{allTracks:0})}}function $t(t){let e,n,s,a,i,l=wt(t[2],t[0]).name+"";return a=new ht({props:{tracks:wt(t[2],t[0]).tracks}}),a.$on("deleteTrack",t[3]),{c(){e=u("h2"),n=d(l),s=f(),R(a.$$.fragment)},m(t,c){r(t,e,c),o(e,n),r(t,s,c),G(a,t,c),i=!0},p(t,e){(!i||5&e)&&l!==(l=wt(t[2],t[0]).name+"")&&b(n,l);const s={};5&e&&(s.tracks=wt(t[2],t[0]).tracks),a.$set(s)},i(t){i||(H(a.$$.fragment,t),i=!0)},o(t){j(a.$$.fragment,t),i=!1},d(t){t&&c(e),t&&c(s),Y(a,t)}}}function Tt(t){let e,n;return e=new gt({props:{allTracks:t[1]}}),e.$on("addTrack",t[4]),{c(){R(e.$$.fragment)},m(t,s){G(e,t,s),n=!0},p(t,n){const s={};2&n&&(s.allTracks=t[1]),e.$set(s)},i(t){n||(H(e.$$.fragment,t),n=!0)},o(t){j(e.$$.fragment,t),n=!1},d(t){Y(e,t)}}}function yt(t){let e,n,s,a=t[2]&&$t(t),i=t[1]&&Tt(t);return{c(){a&&a.c(),e=f(),i&&i.c(),n=h()},m(t,o){a&&a.m(t,o),r(t,e,o),i&&i.m(t,o),r(t,n,o),s=!0},p(t,[s]){t[2]?a?(a.p(t,s),4&s&&H(a,1)):(a=$t(t),a.c(),H(a,1),a.m(e.parentNode,e)):a&&(P(),j(a,1,1,(()=>{a=null})),O()),t[1]?i?(i.p(t,s),2&s&&H(i,1)):(i=Tt(t),i.c(),H(i,1),i.m(n.parentNode,n)):i&&(P(),j(i,1,1,(()=>{i=null})),O())},i(t){s||(H(a),H(i),s=!0)},o(t){j(a),j(i),s=!1},d(t){a&&a.d(t),t&&c(e),i&&i.d(t),t&&c(n)}}}function wt(t,e){return t.find((t=>t.id==e))}function At(t,e,n){let{playlistId:s}=e,{backend:a}=e,i=null,o=null;return a.subscribe("TRACK_LIST",(t=>{n(1,i=t)})),a.subscribe("PLAYLIST_LIST",(t=>{n(2,o=t)})),t.$$set=t=>{"playlistId"in t&&n(0,s=t.playlistId),"backend"in t&&n(5,a=t.backend)},[s,i,o,function(t){let e=t.detail;a.removeTrackFromPlaylist(s,e.id)},async function(t){let e=t.detail;a.addTrackToPlaylist(s,e.id)},a]}class vt extends F{constructor(t){super(),B(this,t,At,yt,i,{playlistId:0,backend:5})}}function Et(e){let n,a,i,l,h,b,g,$,T,y,w,A,v,E,_,S,U,N,x;return{c(){n=u("div"),a=u("div"),i=u("label"),i.textContent="Title",l=f(),h=u("input"),g=f(),$=u("div"),T=u("label"),T.textContent="Artist",y=f(),w=u("input"),v=f(),E=u("div"),_=u("button"),S=d("Add"),m(i,"for","new-track-title"),m(h,"id","new-track-title"),h.disabled=b="SUBMITTING"==e[3],m(h,"class","svelte-cv31d2"),m(a,"class","track-name"),m(T,"for","new-track-artist"),m(w,"id","new-track-artist"),w.disabled=A="SUBMITTING"==e[3],m(w,"class","svelte-cv31d2"),m($,"class","track-artist"),_.disabled=U="SUBMITTING"==e[3],m(E,"class","track-ctrl svelte-cv31d2"),m(n,"class","track svelte-cv31d2")},m(t,s){r(t,n,s),o(n,a),o(a,i),o(a,l),o(a,h),k(h,e[1]),e[7](h),o(n,g),o(n,$),o($,T),o($,y),o($,w),k(w,e[2]),o(n,v),o(n,E),o(E,_),o(_,S),N||(x=[p(h,"input",e[6]),p(w,"input",e[8]),p(_,"click",e[4])],N=!0)},p(t,[e]){8&e&&b!==(b="SUBMITTING"==t[3])&&(h.disabled=b),2&e&&h.value!==t[1]&&k(h,t[1]),8&e&&A!==(A="SUBMITTING"==t[3])&&(w.disabled=A),4&e&&w.value!==t[2]&&k(w,t[2]),8&e&&U!==(U="SUBMITTING"==t[3])&&(_.disabled=U)},i:t,o:t,d(t){t&&c(n),e[7](null),N=!1,s(x)}}}function _t(t,e,n){let s,{backend:a}=e;y();let i="",o="",r="READY";return t.$$set=t=>{"backend"in t&&n(5,a=t.backend)},[s,i,o,r,async function(t){n(3,r="SUBMITTING"),await a.submitTrack(i,o),n(1,i=""),n(2,o=""),n(0,s.value="",s),n(3,r="READY")},a,function(){i=this.value,n(1,i)},function(t){A[t?"unshift":"push"]((()=>{s=t,n(0,s)}))},function(){o=this.value,n(2,o)}]}class St extends F{constructor(t){super(),B(this,t,_t,Et,i,{backend:5})}}function Ut(e){let n;return{c(){n=u("p"),n.textContent="Loading..."},m(t,e){r(t,n,e)},p:t,i:t,o:t,d(t){t&&c(n)}}}function Nt(t){let e,n,s,a;return e=new St({props:{backend:t[0]}}),s=new ht({props:{tracks:t[1]}}),s.$on("deleteTrack",t[2]),{c(){R(e.$$.fragment),n=f(),R(s.$$.fragment)},m(t,i){G(e,t,i),r(t,n,i),G(s,t,i),a=!0},p(t,n){const a={};1&n&&(a.backend=t[0]),e.$set(a);const i={};2&n&&(i.tracks=t[1]),s.$set(i)},i(t){a||(H(e.$$.fragment,t),H(s.$$.fragment,t),a=!0)},o(t){j(e.$$.fragment,t),j(s.$$.fragment,t),a=!1},d(t){Y(e,t),t&&c(n),Y(s,t)}}}function xt(t){let e,n,s,a;const i=[Nt,Ut],o=[];function l(t,e){return t[1]?0:1}return e=l(t),n=o[e]=i[e](t),{c(){n.c(),s=h()},m(t,n){o[e].m(t,n),r(t,s,n),a=!0},p(t,[a]){let r=e;e=l(t),e===r?o[e].p(t,a):(P(),j(o[r],1,1,(()=>{o[r]=null})),O(),n=o[e],n?n.p(t,a):(n=o[e]=i[e](t),n.c()),H(n,1),n.m(s.parentNode,s))},i(t){a||(H(n),a=!0)},o(t){j(n),a=!1},d(t){o[e].d(t),t&&c(s)}}}function It(t,e,n){let{backend:s}=e,a=null;return s.subscribe("TRACK_LIST",(t=>{n(1,a=t)})),t.$$set=t=>{"backend"in t&&n(0,s=t.backend)},[s,a,function(t){let e=t.detail;s.deleteTrack(e.id)}]}class Dt extends F{constructor(t){super(),B(this,t,It,xt,i,{backend:0})}}function Lt(t){let e,n,s,a=t[2].username+"";return{c(){e=d("Hello "),n=d(a),s=d("!")},m(t,a){r(t,e,a),r(t,n,a),r(t,s,a)},p(t,e){4&e&&a!==(a=t[2].username+"")&&b(n,a)},d(t){t&&c(e),t&&c(n),t&&c(s)}}}function Ct(e){let n,s,a,i,l;return{c(){n=u("h2"),n.textContent="404 Not Found",s=f(),a=u("p"),i=d("No such page "),l=d(e[1])},m(t,e){r(t,n,e),r(t,s,e),r(t,a,e),o(a,i),o(a,l)},p(t,e){2&e&&b(l,t[1])},i:t,o:t,d(t){t&&c(n),t&&c(s),t&&c(a)}}}function Pt(t){let e,n,s,a;return s=new vt({props:{backend:t[0],playlistId:t[1].payload}}),{c(){e=u("h2"),e.textContent="Playlist",n=f(),R(s.$$.fragment)},m(t,i){r(t,e,i),r(t,n,i),G(s,t,i),a=!0},p(t,e){const n={};1&e&&(n.backend=t[0]),2&e&&(n.playlistId=t[1].payload),s.$set(n)},i(t){a||(H(s.$$.fragment,t),a=!0)},o(t){j(s.$$.fragment,t),a=!1},d(t){t&&c(e),t&&c(n),Y(s,t)}}}function Ot(t){let e,n,s,a;return s=new Dt({props:{backend:t[0]}}),{c(){e=u("h2"),e.textContent="Library",n=f(),R(s.$$.fragment)},m(t,i){r(t,e,i),r(t,n,i),G(s,t,i),a=!0},p(t,e){const n={};1&e&&(n.backend=t[0]),s.$set(n)},i(t){a||(H(s.$$.fragment,t),a=!0)},o(t){j(s.$$.fragment,t),a=!1},d(t){t&&c(e),t&&c(n),Y(s,t)}}}function Ht(t){let e,n,a,i,l,d,h,b,k,g,$,T,y,w,A,v,E,_,S,U,N,x=t[2]&&Lt(t);b=new ct({props:{backend:t[0]}}),b.$on("showPlaylist",t[4]);const I=[Ot,Pt,Ct],D=[];function L(t,e){return"library"==t[1].screen?0:"playlist"==t[1].screen?1:2}return E=L(t),_=D[E]=I[E](t),{c(){e=u("div"),n=u("aside"),a=u("h1"),a.textContent="Aceplay",i=f(),x&&x.c(),l=f(),d=u("nav"),h=u("ul"),R(b.$$.fragment),k=f(),g=u("li"),$=u("button"),$.textContent="Library",T=f(),y=u("li"),w=u("button"),w.textContent="Sign Out",A=f(),v=u("main"),_.c(),m(h,"class","svelte-15ljv7x"),m(n,"class","sidebar svelte-15ljv7x"),m(v,"class","main svelte-15ljv7x"),m(e,"class","grid svelte-15ljv7x")},m(s,c){r(s,e,c),o(e,n),o(n,a),o(n,i),x&&x.m(n,null),o(n,l),o(n,d),o(d,h),G(b,h,null),o(h,k),o(h,g),o(g,$),o(h,T),o(h,y),o(y,w),o(e,A),o(e,v),D[E].m(v,null),S=!0,U||(N=[p($,"click",t[5]),p(w,"click",t[6])],U=!0)},p(t,[e]){t[2]?x?x.p(t,e):(x=Lt(t),x.c(),x.m(n,l)):x&&(x.d(1),x=null);const s={};1&e&&(s.backend=t[0]),b.$set(s);let a=E;E=L(t),E===a?D[E].p(t,e):(P(),j(D[a],1,1,(()=>{D[a]=null})),O(),_=D[E],_?_.p(t,e):(_=D[E]=I[E](t),_.c()),H(_,1),_.m(v,null))},i(t){S||(H(b.$$.fragment,t),H(_),S=!0)},o(t){j(b.$$.fragment,t),j(_),S=!1},d(t){t&&c(e),x&&x.d(),Y(b),D[E].d(),U=!1,s(N)}}}function jt(t,e,n){const s=y();let{backend:a}=e,i={screen:"library",payload:null},o=null;a.subscribe("USER",(t=>{n(2,o=t)}));return t.$$set=t=>{"backend"in t&&n(0,a=t.backend)},[a,i,o,s,function(t){n(1,i={screen:"playlist",payload:t.detail.id})},()=>n(1,i={screen:"library",payload:null}),()=>s("signOut")]}class Rt extends F{constructor(t){super(),B(this,t,jt,Ht,i,{backend:0})}}function Gt(e){let n,s,a,i,o,l,d,h;return a=new X({}),a.$on("loginSubmit",e[2]),d=new et({}),d.$on("signupSubmit",e[3]),{c(){n=u("h2"),n.textContent="Login",s=f(),R(a.$$.fragment),i=f(),o=u("h2"),o.textContent="Signup",l=f(),R(d.$$.fragment)},m(t,e){r(t,n,e),r(t,s,e),G(a,t,e),r(t,i,e),r(t,o,e),r(t,l,e),G(d,t,e),h=!0},p:t,i(t){h||(H(a.$$.fragment,t),H(d.$$.fragment,t),h=!0)},o(t){j(a.$$.fragment,t),j(d.$$.fragment,t),h=!1},d(t){t&&c(n),t&&c(s),Y(a,t),t&&c(i),t&&c(o),t&&c(l),Y(d,t)}}}function Yt(e){let n,s;return n=new Rt({props:{backend:e[1]}}),n.$on("signOut",e[4]),{c(){R(n.$$.fragment)},m(t,e){G(n,t,e),s=!0},p:t,i(t){s||(H(n.$$.fragment,t),s=!0)},o(t){j(n.$$.fragment,t),s=!1},d(t){Y(n,t)}}}function zt(e){let n;return{c(){n=u("p"),n.textContent="Loading..."},m(t,e){r(t,n,e)},p:t,i:t,o:t,d(t){t&&c(n)}}}function Bt(t){let e,n,s,a;const i=[zt,Yt,Gt],o=[];function l(t,e){return"PENDING_AUTH"==t[0]?0:"AUTHED"==t[0]?1:"UNAUTH"==t[0]?2:-1}return~(e=l(t))&&(n=o[e]=i[e](t)),{c(){n&&n.c(),s=h()},m(t,n){~e&&o[e].m(t,n),r(t,s,n),a=!0},p(t,[a]){let r=e;e=l(t),e===r?~e&&o[e].p(t,a):(n&&(P(),j(o[r],1,1,(()=>{o[r]=null})),O()),~e?(n=o[e],n?n.p(t,a):(n=o[e]=i[e](t),n.c()),H(n,1),n.m(s.parentNode,s)):n=null)},i(t){a||(H(n),a=!0)},o(t){j(n),a=!1},d(t){~e&&o[e].d(t),t&&c(s)}}}function Ft(t,e,n){let s="PENDING_AUTH",a=new M;return a.isAuthenticated().then((t=>{n(0,s=t?"AUTHED":"UNAUTH")})),[s,a,async function(t){let{username:e,password:i}=t.detail;n(0,s="PENDING_AUTH");let o=await a.authenticate(e,i);n(0,s=o?"AUTHED":"UNAUTH")},async function(t){let{username:e,password:i}=t.detail;n(0,s="PENDING_AUTH");let o=await a.signUp(e,i);n(0,s=o?"AUTHED":"UNAUTH")},function(){n(0,s="UNAUTH"),a.signOut()}]}return new class extends F{constructor(t){super(),B(this,t,Ft,Bt,i,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
